(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{447:function(s,t,n){"use strict";n.r(t);var a=n(5),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"nfs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nfs"}},[s._v("#")]),s._v(" NFS")]),s._v(" "),t("h3",{attrs:{id:"注意"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[s._v("#")]),s._v(" 注意")]),s._v(" "),t("ol",[t("li",[s._v("权限问题")]),s._v(" "),t("li")]),s._v(" "),t("h3",{attrs:{id:"搭建服务端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搭建服务端"}},[s._v("#")]),s._v(" 搭建服务端")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nfs-kernel-server\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /mnt/demo\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意： 移除权限？")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" nobody:nogroup /mnt/demo\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" /mnt/demo\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /etc/exports\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#-----")]),s._v("\n/mnt/demo "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.0/24"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,sync,no_subtree_check"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#-----")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" exportfs "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-arv")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart nfs-kernel-server\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"挂载目录权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#挂载目录权限"}},[s._v("#")]),s._v(" 挂载目录权限")]),s._v(" "),t("ul",[t("li",[s._v("* ：允许所有的网段访问，也可以使用具体的IP")]),s._v(" "),t("li",[s._v("ro: 只读")]),s._v(" "),t("li",[s._v("rw：读写操作。客户端机器拥有对卷的读写权限。")]),s._v(" "),t("li",[s._v("sync: 所有数据在请求时写入共享")]),s._v(" "),t("li",[s._v("async: 优先将数据保存到内存，然后再写入硬盘；这样效率更高，但可能会丢失数据")]),s._v(" "),t("li",[s._v("root_squash: 当NFS客户端以root管理员访问时，映射为NFS服务器的匿名用户")]),s._v(" "),t("li",[s._v("no_root_squash ：root用户具有对根目录的完全管理访问权限。")]),s._v(" "),t("li",[s._v("subtree_check: 如果共享 /usr/bin 之类的子目录时，强制 nfs 检查父目录的权限(默认)")]),s._v(" "),t("li",[s._v("no_subtree_check：不检查父目录权限,防止子树检查，即禁用客户端挂载允许的子目录所需的安全验证。")]),s._v(" "),t("li",[s._v("all_squash: 无论NFS客户端使用什么账户访问，均映射为NFS服务器的匿名用户,共享文件的 UID 和 GID 映射匿名用户 nfsnobody，适合公用目录")]),s._v(" "),t("li",[s._v("no_all_squash: 保留共享文件的 UID 和 GID(默认)")]),s._v(" "),t("li",[s._v("secure: nfs 通过 1024 以下的安全 TCP/IP 端口发送")]),s._v(" "),t("li",[s._v("insecure: nfs 通过 1024 以上的端口发送")]),s._v(" "),t("li",[s._v("wdelay: 如果多个用户要写入 nfs 目录，则归组写入(默认)")]),s._v(" "),t("li",[s._v("no_wdelay: 如果多个用户要写入 nfs 目录，则立即写入，当使用 async 时，无需此设置")]),s._v(" "),t("li",[s._v("hide: 在 nfs 共享目录中不共享其子目录")]),s._v(" "),t("li",[s._v("no_hide: 共享 nfs 目录的子目录")]),s._v(" "),t("li",[s._v("anonuid=xxxx: 指定 nfs 服务器 /etc/passwd 文件中匿名用户的 UID")]),s._v(" "),t("li",[s._v("anongid=xxxx: 指定 nfs 服务器 /etc/passwd 文件中匿名用户的 GID")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只能用一个 flag")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -e\t显示NFS服务器的共享列表")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -a\t显示本机挂载的NFS资源的情况")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -v\t显示版本号")]),s._v("\nshowmount "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"客户端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#客户端"}},[s._v("#")]),s._v(" 客户端")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nfs-common\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" nfs "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:/mnt/demo  /tmp/test-nfs\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"其他"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[s._v("#")]),s._v(" 其他")]),s._v(" "),t("p",[s._v("HA： https://www.cnblogs.com/kevingrace/p/13970193.html\nNFS配置动态持久化存储1: https://cloud.tencent.com/developer/article/1751878\nNFS配置动态持久化存储2: https://jimmysong.io/kubernetes-handbook/practice/using-nfs-for-persistent-storage.html\n不同版本的NFS https://cloud.tencent.com/developer/beta/article/1529156")])])}),[],!1,null,null,null);t.default=e.exports}}]);