(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{428:function(s,a,t){"use strict";t.r(a);var e=t(5),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h4",{attrs:{id:"file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#file"}},[s._v("#")]),s._v(" file")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/file",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/file"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" /lib/i386-linux-gnu/libc-2.27.so \n/lib/i386-linux-gnu/libc-2.27.so: ELF "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("-bit LSB shared object, Intel "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80386")]),s._v(", version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GNU/Linux"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", dynamically linked, interpreter /lib/ld-linux.so.2, BuildID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sha1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("950ee16c67f08465acbfe0bbce1b9993e725ab38, "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" GNU/Linux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),s._v(".0, stripped\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"size"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#size"}},[s._v("#")]),s._v(" size")]),s._v(" "),a("p",[s._v("获取ELF节的字节长度信息")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/size",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/size"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ size /lib/i386-linux-gnu/libc-2.27.so \n   text\t   data\t    bss\t    dec\t    hex\tfilename\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1917945")]),s._v("\t  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11624")]),s._v("\t  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11116")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1940685")]),s._v("\t 1d9ccd\t/lib/i386-linux-gnu/libc-2.27.so\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"binutils"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#binutils"}},[s._v("#")]),s._v(" binutils")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.gnu.org/software/binutils/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.gnu.org/software/binutils/"),a("OutboundLink")],1)]),s._v(" "),a("h4",{attrs:{id:"ldd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ldd"}},[s._v("#")]),s._v(" ldd")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/ldd",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/ldd"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("显示出客户二进制文件启动时需要"),a("strong",[s._v("静态加载的动态库")]),s._v("的完整列表（即加载时依赖项）")]),s._v(" "),a("ul",[a("li",[s._v("ldd无法识别出运行时通过调用dlopen()函数动态加载的动态库。")]),s._v(" "),a("li",[s._v("根据ldd手册页的描述，运行某些版本的ldd可能会导致安全问题。"),a("strong",[s._v("在一些环境中某些版本的ldd可能会尝试执行程序来获取依赖信息")]),s._v(",用更安全的方法代替ldd")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("objdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /usr/bin/gst-inspect-1.0  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" NEEDED\nreadelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" /usr/bin/gst-inspect-1.0  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" NEEDED\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("自己执行递归依赖搜索过程???")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ ldd /usr/bin/gst-inspect-1.0 \n\tlinux-vdso.so.1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007ffec8504000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibgstreamer-1.0.so.0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/lib/x86_64-linux-gnu/libgstreamer-1.0.so.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc74a60a000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibgobject-2.0.so.0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/lib/x86_64-linux-gnu/libgobject-2.0.so.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc74a3b6000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibglib-2.0.so.0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/lib/x86_64-linux-gnu/libglib-2.0.so.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc74a09f000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibc.so.6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib/x86_64-linux-gnu/libc.so.6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc749cae000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibgmodule-2.0.so.0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/lib/x86_64-linux-gnu/libgmodule-2.0.so.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc749aaa000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibm.so.6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib/x86_64-linux-gnu/libm.so.6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc74970c000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibrt.so.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib/x86_64-linux-gnu/librt.so.1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc749504000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibdl.so.2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib/x86_64-linux-gnu/libdl.so.2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc749300000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibpthread.so.0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib/x86_64-linux-gnu/libpthread.so.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc7490e1000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibffi.so.6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/lib/x86_64-linux-gnu/libffi.so.6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc748ed9000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlibpcre.so.3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib/x86_64-linux-gnu/libpcre.so.3 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc748c68000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t/lib64/ld-linux-x86-64.so.2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fc74ab50000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ objdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /usr/bin/gst-inspect-1.0  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" NEEDED\n  NEEDED               libgstreamer-1.0.so.0\n  NEEDED               libgobject-2.0.so.0\n  NEEDED               libglib-2.0.so.0\n  NEEDED               libc.so.6\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ readelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" /usr/bin/gst-inspect-1.0  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" NEEDED\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             共享库："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("libgstreamer-1.0.so.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             共享库："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("libgobject-2.0.so.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             共享库："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("libglib-2.0.so.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             共享库："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("libc.so.6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h4",{attrs:{id:"nm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nm"}},[s._v("#")]),s._v(" nm")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/nm",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/nm"),a("OutboundLink")],1)]),s._v(" "),a("ul",[a("li",[s._v("$ nm <二进制文件路径>：列出二进制文件的"),a("strong",[s._v("所有符号")]),s._v(".对于共享库而言，不仅会列出导出符号（在.dynamic节中的符号），也会列出其他所有符号。如果你除去了库文件中的某些符号（通过strip命令），那么在不使用参数(-D)调用nm命令时，nm将找不到这些被去除的符号;")]),s._v(" "),a("li",[s._v("$ nm-D <二进制文件路径>：只列出"),a("strong",[s._v("动态节中的符号")]),s._v("（即共享库中导出的或对外可见的符号）;")]),s._v(" "),a("li",[s._v("$ nm-C <二进制文件路径>：列出"),a("strong",[s._v("未经过名称修饰的符号")])]),s._v(" "),a("li",[s._v("$ nm -D --no-demangle <二进制文件路径>：打印出共享库中名称"),a("strong",[s._v("修饰后的动态符号")]),s._v(";")]),s._v(" "),a("li",[s._v("$ nm -A <库文件路径>/*|grep symbol-name：-A选项会将所有在库中找到的符号名打印出来;")]),s._v(" "),a("li",[s._v("$ nm -u <二进制文件路径>：列出库中未定义的符号（这个"),a("strong",[s._v("库文件本身并不包含该符号")]),s._v("，但期望在运行时加载的其他动态库中提供）;")])]),s._v(" "),a("h4",{attrs:{id:"objdump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#objdump"}},[s._v("#")]),s._v(" objdump")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/objdump",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/objdump"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("1.解析ELF头")]),s._v(" "),a("p",[s._v("objdump命令的-f选项可以用来获取目标文件头信息。ELF头提供了大量有用的信息。尤其可以通过ELF头信息快速获取二进制文件类型（目标文件、静态库、动态库和可执行文件）和入口点信息（.text节的起点）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ objdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("  /usr/lib/i386-linux-gnu/libcups.so.2 \n\n/usr/lib/i386-linux-gnu/libcups.so.2：     文件格式 elf32-i386\n体系结构：i386， 标志 0x00000150：\nHAS_SYMS, DYNAMIC, D_PAGED\n起始地址 0x0000f420\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("2.列出并查看节信息")]),s._v(" "),a("p",[s._v("objdump-h选项用来列出所有二进制文件的节.")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("/usr/lib/i386-linux-gnu/libcups.so.2：     文件格式 elf32-i386\n\n节：\nIdx Name          Size      VMA       LMA       File off  Algn\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" .note.gnu.build-id 00000024  00000114  00000114  00000114  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" .gnu.hash     00001304  00000138  00000138  00000138  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" .dynsym       00003220  0000143c  0000143c  0000143c  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" .dynstr       0000318d  0000465c  0000465c  0000465c  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**0\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" .gnu.version  00000644  000077ea  000077ea  000077ea  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**1\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" .gnu.version_r 00000170  00007e30  00007e30  00007e30  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" .rel.dyn      00005ed0  00007fa0  00007fa0  00007fa0  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" .rel.plt      00000718  0000de70  0000de70  0000de70  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" .init         00000023  0000e588  0000e588  0000e588  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" .plt          00000e40  0000e5b0  0000e5b0  0000e5b0  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" .plt.got      00000028  0000f3f0  0000f3f0  0000f3f0  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**3\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" .text         0004c224  0000f420  0000f420  0000f420  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" .fini         00000014  0005b644  0005b644  0005b644  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("**2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("列出所有符号")])]),s._v(" "),a("p",[s._v("objdump -t<二进制文件路径>命令与nm<二进制文件路径>命令的执行结果完全相同")]),s._v(" "),a("p",[s._v("4.列出动态符号")]),s._v(" "),a("p",[s._v("objdump -T<二进制文件路径>命令与nm -D<二进制文件路径>命令的执行结果完全相同")]),s._v(" "),a("p",[s._v("5.查看动态节")]),s._v(" "),a("p",[s._v("执行objdump-p<二进制文件路径>命令可以查看动态节信息（以查看DT_RPATH和DT_RUNPATH设置）")]),s._v(" "),a("p",[s._v("6.查看重定位节")]),s._v(" "),a("p",[s._v("执行objdump-R<二进制文件路径>命令可以查看重定位节的信息")]),s._v(" "),a("p",[s._v("7.查看节中的数据")]),s._v(" "),a("p",[s._v("执行objdump-s-j<节的名称><二进制文件路径>命令可以指定某个节，并提供其数据的十六进制转储信息。")]),s._v(" "),a("p",[s._v("8.列出并查看段")]),s._v(" "),a("p",[s._v("执行objdump -p<二进制文件路径>命令可以查看ELF二进制段的信息。")]),s._v(" "),a("p",[s._v("9.反汇编代码")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ objdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Mintel")]),s._v("  /usr/lib/i386-linux-gnu/libcups.so.2  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" ebx,0x365\n   5b636:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("81")]),s._v(" c3 e6 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),s._v(" 03 00    \t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v("    ebx,0x365e6\n   5b63c:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v(" ec 08             \tsub    esp,0x8\n   5b63f:\te8 5c "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(" fb ff       \tcall   efa0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("__stack_chk_fail@plt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nDisassembly of section .fini:\n\n0005b644 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("_fini@@Base"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":\n   5b644:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v("                   \tpush   ebx\n   5b645:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v(" ec 08             \tsub    esp,0x8\n   5b648:\te8 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("73")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" fb ff       \tcall   f6c0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("__cxa_finalize@plt+0x2b"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\n   5b64d:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("81")]),s._v(" c3 cf "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),s._v(" 03 00    \t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v("    ebx,0x365cf\n   5b653:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v(" c4 08             \t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v("    esp,0x8\n   5b656:\t5b                   \tpop    ebx\n   5b657:\tc3                   \tret    \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("只有在构建时开启了调试（也就是-g选项）时该选项才能正常使用。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("objdump  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-S")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Mintel")]),s._v("  /usr/lib/i386-linux-gnu/libcups.so.2  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<sharedlib1Function>"')]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("在默认情况下，objdump会反汇编所有包含代码的节。但有时你可能只对查看特定节中的代码感兴趣")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ objdump  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-S")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Mintel")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" .fini  /usr/lib/i386-linux-gnu/libcups.so.2 \n\n/usr/lib/i386-linux-gnu/libcups.so.2：     文件格式 elf32-i386\n\n\nDisassembly of section .fini:\n\n0005b644 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("_fini@@Base"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":\n   5b644:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v("                   \tpush   ebx\n   5b645:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v(" ec 08             \tsub    esp,0x8\n   5b648:\te8 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("73")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" fb ff       \tcall   f6c0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("__cxa_finalize@plt+0x2b"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\n   5b64d:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("81")]),s._v(" c3 cf "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),s._v(" 03 00    \t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v("    ebx,0x365cf\n   5b653:\t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v(" c4 08             \t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v("    esp,0x8\n   5b656:\t5b                   \tpop    ebx\n   5b657:\tc3                   \tret   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"readelf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#readelf"}},[s._v("#")]),s._v(" readelf")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/readelf",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/readelf"),a("OutboundLink")],1)]),s._v(" "),a("ul",[a("li",[s._v("readelf只支持ELF二进制格式。")]),s._v(" "),a("li",[s._v("readelf不依赖于二进制文件描述库(http://en.wikipedia.org/wiki/Binary_File_Descriptor_library)，而GNU的所有目标文件解析工具则都依赖于这个库，因此readelf可以独立地提供ELF格式的信息。")])]),s._v(" "),a("p",[s._v("1.解析ELF头 readelf -h\n2.列出并查看节信息 readelf -S\n3.列出所有符号 readelf --symbols\n4.列出动态符号readelf --dyn-syms\n5.查看动态节执行readelf -d命令可以查看动态节的信息（以查看DT_RPATH和DT_RUNPATH设置）\n6.查看重定位节执行readelf -r命令可以查看重定位节的信息\n8. 列出并查看段执行readelf --segments命令可以显示ELF二进制文件的段信息\n9. 检测二进制文件是否包含调试信息readelf命令可以很好地显示出二进制文件中包含的各类调试信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("readelf --debug-dump-line\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ readelf --debug-dump"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("line  /usr/lib/i386-linux-gnu/libcups.so.2  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"部署阶段工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署阶段工具"}},[s._v("#")]),s._v(" 部署阶段工具")]),s._v(" "),a("h4",{attrs:{id:"chrpath"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#chrpath"}},[s._v("#")]),s._v(" chrpath")]),s._v(" "),a("ul",[a("li",[s._v("可以在DT_RPATH原始字符串长度的范围内对其进行修改,如果DT_RPATH字符串原来就是空的，那么不能使用任何的非空字符串替代原有字段;")]),s._v(" "),a("li",[s._v("可以删除原有的DT_RPATH字段;")]),s._v(" "),a("li",[s._v("可以将DT_RPATH转换成DT_RUNPATH;")]),s._v(" "),a("li",[s._v("用于替代的字符串长度不能超过原本存在的DT_RPATH字符串的长度;")])]),s._v(" "),a("h4",{attrs:{id:"patchelf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#patchelf"}},[s._v("#")]),s._v(" patchelf")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://nixos.org/patchelf.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://nixos.org/patchelf.html"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("该工具可以设置和修改ELF二进制文件的runpath（DT_RUNPATH字段）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("patchelf --set-rpath "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("paths"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("executable"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"strip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#strip"}},[s._v("#")]),s._v(" strip")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/strip",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/strip"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("可以清除所有动态加载过程中不需要的库文件符号")]),s._v(" "),a("h4",{attrs:{id:"ldconfig"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ldconfig"}},[s._v("#")]),s._v(" ldconfig")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/8/ldconfig",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/8/ldconfig"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("可以通过ldconfig缓存指定装载器运行时的库搜索路径。")]),s._v(" "),a("ul",[a("li",[s._v("/etc/ld.so.conf文件：包含了一组目录列表，默认会扫描里面的库文件。")]),s._v(" "),a("li",[s._v("/etc/ld.so.cache文件：将多个路径作为输入参数传递给ldconfig时，ldconfig会将整个扫描过程中查找到的动态库的文件名以ASCII文本列表的形式写入这个文件。")])]),s._v(" "),a("h3",{attrs:{id:"运行时分析工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行时分析工具"}},[s._v("#")]),s._v(" 运行时分析工具")]),s._v(" "),a("h4",{attrs:{id:"strace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#strace"}},[s._v("#")]),s._v(" strace")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/strace",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/strace"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("可以用来分析加载时的依赖项")]),s._v(" "),a("h4",{attrs:{id:"addr2line"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#addr2line"}},[s._v("#")]),s._v(" addr2line")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/1/addr2line",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/1/addr2line"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("可以将运行时地址转换成地址所对应的源代码文件信息和行号")]),s._v(" "),a("p",[s._v("当（且仅当）使用调试模式构建二进制文件（"),a("strong",[s._v("通过传递-g -O0编译器选项")]),s._v("）时，使用该工具有助于分析程序崩溃信息")]),s._v(" "),a("h4",{attrs:{id:"gdb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gdb"}},[s._v("#")]),s._v(" gdb")]),s._v(" "),a("ul",[a("li",[s._v("set disassembly-flavor<intel|att>；")]),s._v(" "),a("li",[s._v("disassemble<函数名>；")]),s._v(" "),a("li",[s._v("/r选项：显示额外的汇编指令的十六进制代码（见图12-32）；")]),s._v(" "),a("li",[s._v("/m选项：在汇编指令中插入对应的C/C++代码行。")])]),s._v(" "),a("h3",{attrs:{id:"静态库工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态库工具"}},[s._v("#")]),s._v(" 静态库工具")]),s._v(" "),a("h4",{attrs:{id:"ar"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ar"}},[s._v("#")]),s._v(" ar")]),s._v(" "),a("p",[s._v("1.创建静态库")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ar-rcs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("库文件名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("目标文件列表"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("列出静态库目标文件")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ar-t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("库文件名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("3.从静态库中删除目标文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ar "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("库文件名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("需要删除的目标文件"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("4.将新的目标文件添加到静态库")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ar "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("库文件名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("需要添加的目标文件"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("5.重建目标文件顺序")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ar-m "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("静态库中的目标文件，被移动的目标文件会移动到该文件前面"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("库文件名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("需要移动顺序的目标文件"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实践"}},[s._v("#")]),s._v(" 实践")]),s._v(" "),a("h4",{attrs:{id:"链接过程调试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#链接过程调试"}},[s._v("#")]),s._v(" 链接过程调试")]),s._v(" "),a("p",[s._v("预设置 LD_DEBUG=")]),a("option",[a("p"),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LD_DEBUG")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("help "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v("\nValid options "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the LD_DEBUG environment variable are:\n\n  libs        display library search paths\n  reloc       display relocation processing\n  files       display progress "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" input "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n  symbols     display symbol table processing\n  bindings    display information about symbol binding\n  versions    display version dependencies\n  scopes      display scope information\n  all         all previous options combined\n  statistics  display relocation statistics\n  unused      determined unused DSOs\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v("        display this "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" message and "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n\nTo direct the debugging output into a "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" instead of standard output\na filename can be specified using the LD_DEBUG_OUTPUT environment variable.\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h4",{attrs:{id:"确定二进制文件类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#确定二进制文件类型"}},[s._v("#")]),s._v(" 确定二进制文件类型")]),s._v(" "),a("p",[s._v("file、readelf")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("readelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" Type\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ readelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" /bin/cat  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" 类型\n  类型:                              DYN "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("共享目标文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ \n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("EXEC（可执行文件）\\ DYN（共享目标文件）\\REL（可重定位文件）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ objdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /bin/cat \n\n/bin/cat：     文件格式 elf64-x86-64\n体系结构：i386:x86-64， 标志 0x00000150：\nHAS_SYMS, DYNAMIC, D_PAGED\n起始地址 0x0000000000002710\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("EXEC_P（可执行文件）\\ DYNAMIC（共享目标文件）\\ 目标文件不会显示任何类型信息")]),s._v(" "),a("h4",{attrs:{id:"获取可执行文件入口点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取可执行文件入口点"}},[s._v("#")]),s._v(" 获取可执行文件入口点")]),s._v(" "),a("p",[s._v("readelf、objdump")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ readelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" /bin/cat  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" 入口点地址\n  入口点地址：               0x2710\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" lv@lv:rnotes$ objdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /bin/cat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v("  起始地址\n起始地址 0x0000000000002710\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"获取动态库入口点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取动态库入口点"}},[s._v("#")]),s._v(" 获取动态库入口点")]),s._v(" "),a("p",[s._v("由于动态库会被映射到客户二进制文件的进程内存映射中去，因此只有在运行时才能获得动态库真正的入口点。")]),s._v(" "),a("ul",[a("li",[s._v("在GNU调试器中执行应用程序并加载动态库")]),s._v(" "),a("li",[s._v("在main()函数的位置设一个断点即可。无论可执行文件有没有使用调试选项构建，一般都能找到这个符号")]),s._v(" "),a("li",[s._v("当程序执行到设置在main()函数位置的断点时，加载进程也已经完成")]),s._v(" "),a("li",[s._v("将大量屏幕输出重定向到指定文件中去，然后手动查询。")])]),s._v(" "),a("h4",{attrs:{id:"列出符号信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#列出符号信息"}},[s._v("#")]),s._v(" 列出符号信息")]),s._v(" "),a("p",[s._v("nm、readelf")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对外可见符号")]),s._v("\nreadelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--symbols")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导出符号")]),s._v("\nreadelf --dyn-syms "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对外可见符号")]),s._v("\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导出符号")]),s._v("\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-T")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h4",{attrs:{id:"查看节的信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看节的信息"}},[s._v("#")]),s._v(" 查看节的信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 所有节")]),s._v("\nreadelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-S")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nreadelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 动态节")]),s._v("\nreadelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看重定位节的信息")]),s._v("\nreadelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据节")]),s._v("\nreadelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-x")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("section name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("section name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("确定动态库类型（PIC或LTR）")]),s._v(" "),a("p",[s._v("如果构建动态库时没有使用-fPIC编译器选项，那么在动态库的动态节中会有一个TEXTREL字段；如果使用了-fPIC编译器选项，则动态节中不包含该字段。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pic_or_ltr.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" readelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" TEXTREL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"LTR"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-fPIC"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"段信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#段信息"}},[s._v("#")]),s._v(" 段信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("readelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--segments")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nobjdump p "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"反汇编代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反汇编代码"}},[s._v("#")]),s._v(" 反汇编代码")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("objdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 汇编风格")]),s._v("\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-M")]),s._v(" intel "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 带源代码")]),s._v("\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-M")]),s._v(" intel "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-S")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定节")]),s._v("\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-M")]),s._v(" intel "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-S")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" .plt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"是否位调试构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#是否位调试构建"}},[s._v("#")]),s._v(" 是否位调试构建")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("readelf --debug-dump"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("line "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"加载时依赖项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加载时依赖项"}},[s._v("#")]),s._v(" 加载时依赖项")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ldd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nobjdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" NEEDED\nreadelf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" NEEDED\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"查看装载器可以找到的库文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看装载器可以找到的库文件"}},[s._v("#")]),s._v(" 查看装载器可以找到的库文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ldconfig "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("\nldconfig "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"查看运行时动态链接的库文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看运行时动态链接的库文件"}},[s._v("#")]),s._v(" 查看运行时动态链接的库文件")]),s._v(" "),a("ul",[a("li",[s._v("strace, open()和mmap()系统调用")]),s._v(" "),a("li",[s._v("LD_DEBUG=files")]),s._v(" "),a("li",[s._v("/proc/"),a("PID",[s._v("/maps文件")])],1)]),s._v(" "),a("p",[s._v("lsof")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://linux.die.net/man/8/lsof",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://linux.die.net/man/8/lsof"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("对正在运行中的进程进行分析，并将进程打开的所有文件的列表输出到标准输出流中。")]),s._v(" "),a("p",[s._v("这里所谓已打开的文件包括普通文件、目录、块设备文件、字符设备文件、执行中的文本引用(executing text reference)、库文件、流文件和网络文件（Internet socket、NFS文件或UNIX domain socket）。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("lsof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("pgrep firefox"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("-r选项，那么losf将会以无限循环的方式检查运行中的进程，如果想终止进程执行，则需要输入Ctrl-C。")]),s._v(" "),a("p",[s._v("+r选项，那么lsof会在没有侦测到更多打开文件时自动终止。")]),s._v(" "),a("p",[s._v("在程序代码中调用**dl_iterate_phdr()**函数，就可以在运行时打印出加载的共享库的完整列表，以及每个库文件的一些额外数据（比如加载库的起始地址）")]),s._v(" "),a("h4",{attrs:{id:"创建和维护静态库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建和维护静态库"}},[s._v("#")]),s._v(" 创建和维护静态库")]),s._v(" "),a("p",[s._v("ar")])])])}),[],!1,null,null,null);a.default=n.exports}}]);